name: cron_test

on:
  schedule:
    - cron: "*/5 * * * *"

jobs:
  cron:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Use Node.js 20.x
        uses: actions/setup-node@v3
        with:
          node-version: 20.x

      - name: Get List of Tag
        run: |
          TAGS=$(curl -L \
              -H "Accept: application/vnd.github+json" \
              -H "Authorization: Bearer ${{ github.token }}" \
              -H "X-GitHub-Api-Version: 2022-11-28" \
              "https://api.github.com/repos/${{ github.repository }}/git/refs/tags" | jq -r '.[].ref')

          echo "::set-output name=tags::$TAGS"

      - name: Get Tag Names
        run: |
          ASDF=$(git branch --contains 81a0e0626cf9a7efccbd214a50345eb2c67ea3ee)
          echo $ASDF

      # - name: notify to slack
      #   run: |
      #     curl \
      #       -X POST \
      #       --data-urlencode \
      #       "payload={\"channel\": \"#test-for-slack-notification\", \"username\": \"webhookbot\", \"text\": \"이 항목은 #개의 my-channel-here에 포스트되며 webhookbot이라는 봇에서 제공됩니다.\", \"icon_emoji\": \":ghost:\"}" \
      #       https://hooks.slack.com/services/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

#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

#

# TAGS=$(curl -L \
# -H "Accept: application/vnd.github+json" \
# -H "Authorization: Bearer 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" \
# -H "X-GitHub-Api-Version: 2022-11-28" \
# "https://api.github.com/repos/free-cutyapple/test/git/refs/tags" | jq -r '.[].ref | sub("refs/tags/";"")')

# curl -L \
# -H "Accept: application/vnd.github+json" \
# -H "Authorization: Bearer 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" \
# -H "X-GitHub-Api-Version: 2022-11-28" \
# "https://api.github.com/repos/free-cutyapple/test/git/refs/tags" | jq -r '.[].ref | sub("refs/tags/";"")'

# curl -L \
# -H "Accept: application/vnd.github+json" \
# -H "Authorization: Bearer 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" \
# -H "X-GitHub-Api-Version: 2022-11-28" \
# "https://api.github.com/repos/free-cutyapple/test/git/refs/tags"
